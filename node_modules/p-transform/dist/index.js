import { Stream } from 'readable-stream';
import { OutOfOrder } from './queue.js';
export * from './queue.js';
const pipeline = Stream.promises.pipeline;
export { pipeline };
export const transform = (transform) => {
    return new OutOfOrder(transform).duplex();
};
/**
 * Shortcut to create a passthrough with spy.
 */
export const passthrough = (spy) => transform(async (chunk) => {
    await spy?.(chunk);
    return chunk;
});
/**
 * Create a filter stream.
 */
export const filter = (filter) => transform(async function (chunk) {
    const result = await filter(chunk);
    return result ? chunk : undefined;
});
